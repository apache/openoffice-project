<!doctype html>
<!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

         https://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<html lang="en" prefix="og: https://ogp.me/ns#">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Native SVG support for Apache OpenOffice 3.4 (Incubating)</title>




    <!-- Below Meta Tags Generated via https://www.opengraph.xyz -->
    <!-- If you don't care about social media then remove this section -->
    <!-- Values are set in pelicanconf.py -->
    <!-- HTML Meta Tags -->
    <meta name="description" content="The official developer website of the Apache OpenOffice open source project, home of OpenOffice Writer, Calc, Impress, Draw and Base.">
    <meta name="keywords" content="">
    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="https://openoffice.apache.org">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Apache OpenOffice">
    <meta property="og:description" content="The official developer website of the Apache OpenOffice open source project, home of OpenOffice Writer, Calc, Impress, Draw and Base.">
    <meta property="og:image" content="https://openoffice.apache.org/images/AOO4_website_logo.png">
    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="openoffice.apache.org">
    <meta property="twitter:url" content="https://openoffice.apache.org">
    <meta name="twitter:title" content="Apache OpenOffice">
    <meta name="twitter:description" content="The official developer website of the Apache OpenOffice open source project, home of OpenOffice Writer, Calc, Impress, Draw and Base.">
    <meta name="twitter:image" content="https://openoffice.apache.org/images/AOO4_website_logo.png">
    <!-- Above Meta Tags Generated via https://www.opengraph.xyz -->
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>

<body id="index" class="home">
  <div id="banner">
      <div id="bannerleft"><a alt="Apache OpenOffice" href="/">
          <img id="logo" alt="Apache OpenOffice" src="/images/AOO4_website_logo.png" height="60" width="161"/></a></div>
      <div id="bannercenter">The Free and Open Productivity Suite</div>
  </div>
  <div id="clear"></div>
  <nav class="navbar navbar-expand-sm navbar-dark bg-primary">
<button class="navbar-toggler" type="button"
        data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false"
        aria-label="Toggle navigation">
  <span class="navbar-toggler-icon"></span>
</button>

<!-- General menu -->
<div class="collapse navbar-collapse" id="navbarSupportedContent">
  <ul class="navbar-nav mr-auto">
    <li class="nav-item active dropdown">
      <a class="nav-link dropdown-toggle" href="#" id="generalDropdown" role="button" data-toggle="dropdown" aria-expanded="false">General</a>
      <ul class="dropdown-menu" aria-labelledby="generalDropdown">
	<li><a class="dropdown-item" href="/index.html">About</a></li>
	<li><a class="dropdown-item" href="/downloads.html">Downloads</a></li>
	<li><a class="dropdown-item" href="/license.html">License</a></li>
	<li><a class="dropdown-item" href="/mission.html">Mission</a></li>
	<li><a class="dropdown-item" href="/trademarks.html">Trademarks</a></li>
	<li><a class="dropdown-item" href="/press.html">Press</a></li>
	<li><a class="dropdown-item" href="https://www.openoffice.org/">OpenOffice.org</a></li>
      </ul>
    </li>

    <!-- Community menu -->
    <li class="nav-item active dropdown">
      <a class="nav-link dropdown-toggle" href="#" id="communityDropdown" role="button" data-toggle="dropdown" aria-expanded="false">Community</a>
      <ul class="dropdown-menu" aria-labelledby="communityDropdown">
	<li><a class="dropdown-item" href="/get-involved.html">Get Involved</a></li>
	<li><a class="dropdown-item" href="/orientation/index.html">Orientation</a></li>
	<li><a class="dropdown-item" href="/mailing-lists.html">Mailing Lists</a></li>
	<li><a class="dropdown-item" href="/social.html">Social Networking</a></li>
	<li><a class="dropdown-item" href="/events.html">Events</a></li>
	<li><a class="dropdown-item" href="https://www.openoffice.org/support/">Support</a></li>
	<li><a class="dropdown-item" href="/native-lang.html">Native Language</a></li>
	<li><a class="dropdown-item" href="https://cwiki.apache.org/confluence/display/OOOUSERS/">Planning Wiki</a></li>
	<li><a class="dropdown-item" href="/people.html">People</a></li>
	<li><a class="dropdown-item" href="/community-faqs.html">Community FAQs</a></li>
      </ul>
    </li>

    <!-- Development menu -->
    <li class="nav-item active dropdown">
      <a class="nav-link dropdown-toggle" href="#" id="developmentDropdown" role="button" data-toggle="dropdown" aria-expanded="false">Development</a>
      <ul class="dropdown-menu" aria-labelledby="developmentDropdown">
	<li><a class="dropdown-item" href="/source.html">Source Code</a></li>
	<li><a class="dropdown-item" href="/bug-tracking.html">Bug Tracking</a></li>
	<li><a class="dropdown-item" href="/qa.html">Quality Assurance</a></li>
	<li><a class="dropdown-item" href="/translate.html">Translation</a></li>
	<li><a class="dropdown-item" href="/website-local.html">Website</a></li>
	<li><a class="dropdown-item" href="/security.html">Security Reports</a></li>
	<li><a class="dropdown-item" href="/contributing-code.html">Contributing Code</a></li>
	<li><a class="dropdown-item" href="/developer-faqs.html">Developer FAQs</a></li>
      </ul>
    </li>

    <!-- Project menu -->
    <li class="nav-item active dropdown">
      <a class="nav-link dropdown-toggle" href="#" id="projectDropdown" role="button" data-toggle="dropdown" aria-expanded="false">Project</a>
      <ul class="dropdown-menu" aria-labelledby="projectDropdown">
        <li><a class="dropdown-item" href="/blogpage.html">Project Blog</a></li>
	<li><a class="dropdown-item" href="/pmc-faqs.html">PMC FAQs</a></li>
      </ul>
    </li>
  </ul>

  <!-- The ASF menu -->
  <div class="navbar-nav" style="padding-top: 0.5rem;">
    <div class="nav-item dropdown dropdown-menu-right active">
      <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <img src="https://www.apache.org/foundation/press/kit/feather.svg"
          width="32" height="32" class="d-inline-block align-top"
          alt="Apache Feather">
        The ASF
      </a>
      <div class="dropdown-menu dropdown-menu-right">
	<a class="dropdown-item" href="https://www.apache.org/">Website</a>
	<a class="dropdown-item" href="https://www.apache.org/licenses/">License</a>
	<a class="dropdown-item" href="https://www.apache.org/security/">Security</a>
	<a class="dropdown-item" href="https://www.apache.org/events/current-event">Events</a>
	<a class="dropdown-item" href="https://www.openoffice.org/donations.html">Donations</a>
	<a class="dropdown-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
	<a class="dropdown-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a>
      </div>
    </div>
  </div>
</div>  </nav>
  <div id="contenta">
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://openoffice.apache.org/blog/native_svg_support_for_apache.html" rel="bookmark"
         title="Permalink to Native SVG support for Apache OpenOffice 3.4 (Incubating)">Native SVG support for Apache OpenOffice 3.4 (Incubating)</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2012-01-19T11:02:42+00:00">
      Thu 19 January 2012
    </time>
    <div class="category">
        Category: <a href="https://openoffice.apache.org/category/blog.html">blog</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>Apache OpenOffice 3.4 supports embedding SVG graphics using a newly created native SVG interpreter implementation. I want to talk about the advantages and some internals of this solution and the necessary changes done.<br/></p>
<p>One reason to do this was IP clearance. It allowed removal of six GPL/LGPL libraries, namely 
librsvg, libcroco, libgsf, gdk-pixbuf, glib, and pango gettext. These 
were used as an external pixel-based renderer. The new SVG uses an own internal 
interpreter in a new library and some new UNO API services. IP clearance was no interesting task to do, but it leaded to effects like here with SVG; the install sets get smaller (less libraries to deliver), the app needs less libraries (startup, memory, runtime) and the internal handling of SVG vector data is completely vector-graphic oriented.<br/> <br/>There were also ODF-compatible File Format adaptions needed, more concrete the in ODF already contained and described multi-image support. In ODF, the original SVG is now embedded to the 'Pictures' folder inside the ODF file as one 
would expect from such a feature and can be easily extracted (unzip the ODF file and there you are). There is also a Png file 
written as replacement image. The draw:frame is now multi-image 
capable (as the spec allows). In the case of a SVG it writes a good 
quality Png and the original SVG as draw:image elements. Since older 
(and other) office versions are only capable of loading a single (and 
thus the first) image, the Png is written first. This allows file 
exchange with other and older offices without breaking backward compatibility and/or ODF file exchange. At load time, multi-image support 
will choose the best quality graphic available for further work, e.g. 
preferring vector format over pixel format, pixel format with 
alpha over non-alpha and lossless formats over those with 
losing info (you get the idea). Other ODF implementations (e.g. a 
viewer) may just use the pixel graphic available. Multi-image support is 
independent from SVG in principle and will work with all image file 
formats. This is implemented for the Drawinglayer graphic object (used 
in Draw/Impress/Calc) and the Writer graphic object (used in Writer).
<br/> <br/>SVG is no longer interpreted each time it needs to be 
rendered (unavoidable by an external renderer), but only once transformed to a 
sequence of primitives (UNO API graphic atoms). That sequence is then used for all outputs, 
transformed to the graphic object's form and viewport. The 
sequence itself is completely view-independent. Internally, it is reused 
and thus it makes no difference if you have your SVG graphic added once 
or multiple times to your document. This is also true for saving, so always only one copy of your added SVG will be written (the same is true for the replacement 
Png image). Both, the sequence of primitives and the replacement 
image, are created using new UNO API services. One is capable of 
converting an io::XInputStream with SVG content to a sequence of primitives, the other is 
able to convert every sequence of primitives to a rendering::XBitmap 
with given DPI and discrete sizes (pixels, with automatic resolution 
reduction to a given maximum square pixel count to be on the safe side). This will be useful 
for other purposes, too, since it creates a fully alpha-capable 
representation of anything in primitive format to use as e.g. sprite.
<br/> <br/>For all graphic processing the created vector graphic in form 
of a sequence of primitives is used. This means that you will get best 
quality in all zoom situations and all resolutions. This is also true 
for all exports, e.g. printing or PDF export which also uses the vector 
format. With an external renderer, it is unavoidable to use bitmaps with 
discrete solution in those cases, looking bad when zooming and needing more space in most cases as vector data. There is one caveat since not all 
program paths already use primitives; some will use the internal MetaFile 
format in-between (One more reason for more reworks to primitive usages 
in the future).
<br/> <br/>I implemented most SVG features from SVG 1.1, but not yet 
using animations or interactions (but possible in the future due to an 
own interpreter, impossible with an external SVG renderer). It supports 
all geometric SVG forms. It supports SVG gradients (using a new primitive 
for this which will be reused when we add SVG gradients to 
SdrObjects one day), these have a resolution-dependent low-level format 
to not waste runtime on low resolutions. It supports masks, clipPath, markers, linked content, embedded graphics or SVG (intern, extern, 
base64), SVG use nodes, text, text on curve and patterns. It does not yet 
support filters, color profiles, embedded scripts, interactions and 
linking. These can be added when needed, most of them will need to 
implement new primitive types (e.g. filtering) which would be useful for the future
anyways.
Especially interesting is the possibility to later add SVG animation import to GraphicObjects for Impress.<br/> <br/>Some side effects: I had to fix cropping (unified with new primitive) which 
works now also for mirrored graphics (never worked) and quite some other 
stuff. We are prepared for SVG gradients as possible future feature (we 
can already render them now). You can work with an added SVG as with a normal GraphicObject; crop it, break it (to SdrObjects, currently limited to the 
transfer over the old MetaFile format, though). You can convert an 
inserted Tux to 3D, you can bend the SVG in vector quality in Draw. It 
is possible to directly export the original SVG again by selecting the 
object and using 'Save as Picture...' from the context menu. You can add text, line style, fill 
style, pretty much the same as most other graphic objects. You can add 
shadow which casts shadow for the SVG graphic itself as expected (also not possible with an 
external renderer).
<br/> <br/>This is a bigger change, but most stuff is isolated in the 
two mentioned services. There will be errors (I'm too long a programmer 
to deny that :-)), but I tried to be as careful as possible. I already got some help from other community members and fixed some reported bugs (kudos to all testers and bug writers), but to find 
the rest, your help is appreciated. Please feel free to play around with any 
SVG you can find in current AOO 3.4 builds and report problems early in the <a href="https://issues.apache.org/ooo/">Apache bugtracker</a>!
 </p>
<p><a href="http://eric.bachard.org/news/index.php?post/2011/12/03/In-progress-%3A-native-support-of-the-SVG-graphic-format-in-Apache-OpenOffice.org">Here</a> is another blog entry about an early version of this feature.<br/>And <a href="https://cwiki.apache.org/confluence/display/OOOUSERS/AOO+3.4+Unofficial+Developer+Snapshots">here</a> are some developer snapshots of AOO 3.4 when you want to check it out. Be aware that these are AOO 3.4 Unofficial Developer Snapshots; these are intended to be used for early testing by other community volunteers.
  They have no release quality and should not be installed in a 
production environment.  Developer snapshots can be unstable and are 
expected to have bugs.  </p>
<p>Regards,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Armin<br/></p>

  </div><!-- /.entry-content -->
</section>
  </div>

  <footer class="navbar-expand-lg navbar-light bg-light">
    <div class="footer" id="footer">
        <div class="container-fluid">
          Copyright &copy; 2011-2024 The Apache Software Foundation,
          Licensed under the
          <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0.</a> | <a href="/contact.html">Contact Us</a> | <a href="/terms.html">Terms of Use</a> | <a href="https://privacy.apache.org/policies/privacy-policy-public.html">Privacy</a>
          <br/>
          Apache, OpenOffice, OpenOffice.org and the seagull logo are registered trademarks of The Apache Software Foundation.
          The Apache feather logo is a trademark of The Apache Software Foundation.
          Other names appearing on the site may be trademarks of their respective owners.
        </div><!-- #container-fluid -->
        <div class="row container-fluid">
          <div class="col-sm">
            <a href="https://www.apache.org/">
              <img src="https://www.apache.org/img/asf_logo.png" alt="The Apache Software Foundation" style="border: 0; margin-top: 2px" width="200" height="82">
            </a>
          </div>
          <div class="col-sm center-align">
            <a href="https://www.apache.org/foundation/contributing.html">
              <img src="https://www.apache.org/images/SupportApache-small.png" alt="Support The ASF" height="80" width="80">
            </a>
          </div>
          <div class="col-sm right-align">
            <a class="acevent" data-format="wide" data-mode="light" data-event="random"></a>
          </div>
        </div>
    </div>
  </footer>
  <!-- Start load of stylesheets (will need to upgrade periodically) -->
  <link href="/theme/css/bootstrap.min.css" rel="stylesheet" type="text/css">
  <link href="/theme/css/github-markdown.min.css" rel="stylesheet" type="text/css">
  <link href="/theme/css/openoffice.css" rel="stylesheet" type="text/css">
  <!-- End stylesheets -->
  <!-- Start the loading of javascript frameworks (will need to upgrade periodically) -->
  <script src="https://www.apachecon.com/event-images/snippet.js"></script>
  <script src="/theme/js/jquery.slim.min.js"></script>
  <script src="/theme/js/popper.min.js"></script>
  <script src="/theme/js/bootstrap.min.js"></script>
  <!-- End the loading of javascript frameworks -->
<!-- Source: blog/native_svg_support_for_apache.markdown; Template: article; Url: blog/native_svg_support_for_apache.html --></body>
</html>